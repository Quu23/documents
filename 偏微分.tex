\documentclass[a4j,dvipdfmx]{jsarticle}
\usepackage{amsmath,amssymb}
\usepackage{siunitx}

\renewcommand{\thesubsection}{\roman{subsection}}

\begin{document}
\section*{偏微分}
\subsection{二変数の関数}
いままでは、一つの変数$x$の関数$f(x)$を考えてきた。しかし、一つの変数では記述できない現象も多くある。例えば、理想気体の状態方程式を考えてみる。
\begin{equation*}
    pV=RT\quad(R:\text{気体定数})
\end{equation*}
この式中の$p$(圧力)がどのような値を取るのかは、$T$(温度)と$V$(体積)の両方を指定しないと決まらない。

一般に、二つの変数$x$と$y$があり、$x$と$y$の各々の値の組に対して$z$の値が決まるとき、$z$を$x$と$y$の関数といい、
\begin{equation*}
    z=f(x,y)
\end{equation*}
と表す。このとき、$x$と$y$を\textbf{独立変数}、$z$を\textbf{従属変数}という。
\subsubsection*{例題1}
$f(x,y)=x^2+2xy+y^2$であるとき、$x=1,y=-1$のときの$f(x,y)$を求めよ。

\subsubsection*{解答}
$f(x,y)=(x+y)^2=(1-1)^2=0$
\\\\
二変数の関数における極限について考えてみよう。点$P(x,y)$が点$A(a,b)$と一致することなく点Ａに近づくとする。この時、その近づき方によらず、関数$f(x,y)$の値が同じ一つの値$c$
に近づくならば、$f(x,y)$には\textbf{極限}が存在して、その\textbf{極限値}は$c$であるといい、
\begin{equation*}
    f(x,y)\to c\quad(x\to a,y\to b)\qquad\lim_{x\to a,y\to b}f(x,y)=c\qquad\lim_{(x,y)\to(a,b)}f(x,y)=c
\end{equation*}
などと表す。関数$f(x,y)$が$c$に\textbf{収束する}ともいう。

この時、二つほど注意することがある。

(1)極限の定義において、点Pと点Aが一致することは除外している。一般に、点Aが関数$f(x,y)$の定義域に含まれているとは限らない。

(2)点Pが点Aに近づく仕方によって、$f(x,y)$が近づく値が異なるときには、極限は存在しない。


試しに以下の例題を解きながら考えてみよう。
\subsubsection*{例題2}
関数$\displaystyle f(x,y)=\frac{x^2}{x^2+y^2}$において、$x\to 0,y\to 0$の極限を調べ、極限値が存在するかどうか答えよ。


\subsubsection*{解答}
この関数の定義域は、全平面から原点Oを除外して得られる領域である。次の二つの路で、点$P(x,y)$が原点Oに近づくとしよう。

(a)点Pがx軸に沿って近づく場合。
(b)点Pがy軸に沿って近づく場合。\\
(a)の場合は$f(x,0)=1$より、$\displaystyle \lim_{x\to 0}f(x,0)=1$\\
(b)の場合は$f(0,y)=0$より、$\displaystyle \lim_{y\to 0}f(0,y)=0$\\
したがって、この関数は原点への近づき方によって異なる値を取り、極限値$\displaystyle\lim_{x\to 0,y\to 0}f(x,y)$は存在しない。


つづいて、関数の連続について考えてみよう。点$A(a,b)$の近くで定義されている関数$z=f(x,y)$について、次の三つの条件が成り立つ場合、$z=f(x,y)$は点$A(a,b)$において\textbf{連続}であるという。
\begin{enumerate}
    \item $f(a,b)$が定義されている。
    \item $\displaystyle\lim_{(x,y)\to(a,b)}f(x,y)$が存在する。
    \item $\displaystyle\lim_{(x,y)\to(a,b)}f(x,y)=f(a,b)$
\end{enumerate}
例題を解きながら考えてみよう。
\subsubsection*{例題3}
次の関数の原点での連続性についてしらべよ。
\begin{align*}
    &(1)f(x,y)= \left \{
        \begin{array}{l}
        \displaystyle\frac{x^3+y^3}{x^2+y^2} \quad((x,y)\neq(0,0))\\
        0 \qquad\qquad((x,y)=(0,0))
        \end{array}
        \right.\\
    &(2)f(x,y)= \left \{
        \begin{array}{l}
        \displaystyle\frac{xy}{x^2+y^2} \quad((x,y)\neq(0,0))\\
        0 \qquad\qquad((x,y)=(0,0))
        \end{array}
        \right.\\
    &(3)f(x,y)= \left \{
        \begin{array}{l}
        xy \hspace{2mm}\quad\qquad((x,y)\neq(0,0))\\
        2  \hspace{2mm}\quad\qquad\hspace{2mm}((x,y)=(0,0))
        \end{array}
        \right.
\end{align*}

\subsubsection*{解答}
(1)は、$f(0,0)$が存在し、
\begin{equation*}
    \lim_{(x,y)\to(0,0)}f(x)=\lim_{(x,y)\to(0,0)}\frac{x^3+y^3}{x^2+y^2}=0=f(0,0)
\end{equation*}
であるため、この関数は原点で連続である。

(2)$f(0,0)$は定義されている。ここで、原点$y=mx(m\neq 0)$に沿って原点に近づけると、
\begin{equation*}
    \lim_{x\to 0}f(x,mx)=\lim_{x\to 0}\frac{x\cdot mx}{x^2+(mx)^2}=
    \lim_{x\to 0}\frac{mx^2}{(m^2+1)x^2}=\lim_{x\to 0}\frac{m}{m^2+1}\neq f(0,0)
\end{equation*}
であるため、この関数は原点で連続ではない。別解として、直交座標表示から極座標表示に変換して求める方法もある。この場合だと原点に近づけるために必要なパラメータが$r$、つまり
原点からの距離だけとなるのでわかりやすいかもしれない。

(3)$\displaystyle\lim_{(x,y)\to(0,0)}f(x,y)=0\neq f(0,0)$であるため、この間数は連続ではない。もし、$f(0,0)=0$と定義しなおせば、この新しい関数は原点で連続になる。このように、
不連続点で関数を定義しなおすことによって。連続にできるとき、その不連続点は除きうる不連続であるという。
\subsection{偏微分}
関数$z=f(x,y)$において、独立変数$x,y$は、おのおの独立な変数である。どちらかを一定にして、もう片方の変数の値を変えることができる。もちろんどちらも同時に変えることができる。

では、$y$を一定にして$x$を変動させることを考えてみる。この時$f(x,y)$は$x$の関数だから、この$x$の関数の導関数
\begin{equation}
    \frac{\partial f(x,y) }{\partial x}=\lim_{\Delta x\to 0}\frac{f(x+\Delta x,y)-f(x,y)}{\Delta x}
\end{equation}
が存在すれば、\textbf{偏微分可能}であるという。また、$\displaystyle\frac{\partial f}{\partial x}$を$f(x,y)$の$x$に関する\textbf{偏導関数}という。同様に、$x$を一定として$y$を一定として変えたときの導関数を$f(x,y)$の$y$に関する偏導関数という。
一つの変数を定数とみなし、他方の変数で微分するのが、``偏"の意味であり、決して``変"な微分ではない。

偏導関数を表す記法はいろいろある。
\begin{equation*}
    \frac{\partial f(x,y)}{\partial x},f_x,f_x(x,y),\frac{\partial z}{\partial x},\left. \frac{\partial f(x,y)}{\partial x}\right|_y
\end{equation*}
上記の導関数はすべて$x$の偏導関数である。また、最後の記法はどの変数が一定かを強調している記法で、熱力学で多用されるらしい。
なお、$f(x,y)$の偏導関数を求めることを\textbf{偏微分する}という。
\subsubsection*{例題4}
次の関数を偏微分せよ。
\begin{equation*}
    (1)f(x,y)2x^3+5xy+2y^2\quad(2)p(T,V)=\frac{RT}{V}\quad(R:\text{定数})
\end{equation*}
\subsubsection*{解答}
(1)$y$を一定にして$x$で微分すると、$f_x=6x^2+5y$。反対に$x$を一定にして$y$で微分すると、
$f_y=5x+4y$。

(2)\begin{align*}
    &\frac{\partial p}{\partial T}=\frac{R}{V}\\
    &\frac{\partial p}{\partial V}=-\frac{RT}{V^2}
\end{align*}

多くの変数$x,y,z,\cdots ,t$の関数$u=f(x,y,x,\cdots,t)$を\textbf{多変数関数}という。これらも二変数関数と同様に偏導関数を求めることができる。

例えば、$\displaystyle r(x,y,z)=\sqrt{x^2+y^2+z^2}$の偏導関数を求めるとすると。
\begin{equation*}
    r_x=\frac{\partial}{\partial x}\sqrt{x^2+y^2+z^2}=\frac{1}{2}\cdot 2x(x^2+y^2+z^2)^{-\frac{1}{2}}=\frac{x}{r}
\end{equation*}
同様にして、
\begin{equation*}
    r_y=\frac{y}{r}\quad r_z=\frac{z}{r}
\end{equation*}

偏導関数$f_x,f_y$は$x$と$y$の関数であり、さらにそれらの偏導関数を考えることもできる。こうして得られる関数を元の関数の\textbf{二階偏導関数}という。

偏導関数$f_{xy}$は最初に$x$で、つぎの$y$で偏微分したものである。一方$f_{yx}$はその逆の順に偏微分したものである。
一般に、\underbar{$f_{xy}$と$f_{yx}$が連続ならば、}
\begin{equation}
    f_{xy}=f_{yx}
\end{equation}
が成り立つ。すなわち、偏微分の順序を好感しても偏導関数は変わらない。(2)式の拡張として、公開偏導関数においても、それらが連続であれば偏微分の順序を好感しても公開導関数は変わらない。例えば、三階偏導関数がすべて連続ならば、
$f_{xxy}=f_{xyx}=f_{yxx},f_{yyx}=f_{yxy}=f_{xyy}$が成り立つ。
\end{document}
