\documentclass[a4j,dvipdfmx]{jsarticle}
\usepackage{amsmath,amssymb}
% \usepackage{fancybx}
\usepackage{ascmac}
\usepackage{siunitx}

\renewcommand{\thesection}{\Roman{section}}
\renewcommand{\thesubsection}{\roman{subsection}}
% \renewcommand{\thesubsubsection}{\roman{subsubsection}}

\title{積分　解き方集}
\author{$\sum$理学愛好会}
\date{}

\begin{document}
\maketitle
\section{はじめに}
積分の計算は、難しい。微分は式変形をしなくても、公式を適応するだけで解くことができるが、積分はそうはいかない。
自分の計算しやすいように変形する必要があるのだ。うまく公式で扱える範囲に変形するにはある程度知識が必要だ。
だが、それ以上に経験がものをいう。そこで、今回は積分の計算力をつけるため、様々なパターンの積分を解いてもらう。
ある程度進めていくと、どういう式のときにどういう変形をすればいいかが見えてくるようになる。ぜひその``コツ''を
つかんでほしい。

この資料の構成としては、まず始めに積分の感覚をつかむための``基礎の基礎''の問題を載せている。とりあえずそこから取り組んで
いったん体をならすことをお勧めする。つぎに``基礎''の問題として、有理関数の積分や置換積分・部分積分の簡単な計算問題を載せている。
そのあとは、応用問題として少し難しい積分を載せている。積分問題をパターンで分類して、それぞれの解き方も解説していく。

また今回は、実際にこれまでの資料で扱わなかった特殊な積分を併せて紹介していく。それらも同時に覚えていくことで
自分の道具が増えていくことを実感してほしい。


\newpage
\tableofcontents
\clearpage

\section{不定積分の基礎の基礎}
ここでは、置換積分や部分積分を用いないで、単純な変形だけで解ける問題を扱う。基本がわかっていないひとはここから読むべきである。
\subsection{多項式の積分}
ここでは多項式の積分について扱う。先に言葉の復習から行う。多項式とは、
\begin{equation*}
    P(x)=a_0 x^n +a_1 x^{n-1} +\cdots+a_{n-1}x+a_n\quad(\text{$a_0,\cdots,a_n$は定数　$n>1$})
\end{equation*}
となるような$P(x)$のことである。また$P(x)$を$x$についての多項式ともいう。

さて、多項式の積分であるが、これらは$x$のべき乗の和であるため個別に積分できて、
\begin{equation*}
    \int P(x)dx=\int a_0x^ndx +\int a_1 x^{n-1}dx+\cdots+\int a_{n-1}xdx+\int a_ndx
\end{equation*}
となる。それぞれの項の積分は簡単に求められる。
\subsubsection{例題}
\begin{equation*}
    \int (4x^3+3x^2+2x)dx
\end{equation*}
を求めよ。
\subsubsection*{解答}
個別に積分すると、
\begin{equation*}
    \int (4x^3+3x^2+2x)dx=\int 4x^3dx+\int 3x^2dx+\int 2xdx=x^4+x^3+x^2+C
\end{equation*}
となる。最後の積分定数を忘れないように。

\subsubsection{例題}
\begin{equation*}
    \int (x^2+1)^2dx
\end{equation*}
を求めよ。
\subsubsection*{解答}
展開すれば、個別に積分できるので、
\begin{equation*}
    \int (x^2+1)^2dx=\int (x^4+2x^2+1)dx=\int x^4dx+\int 2x^2dx+\int dx=\frac{x^5}{5}+\frac{2}{3}x^3+x+C
\end{equation*}
このように、積の形であっても\underbar{展開して和に直すことで}、個別に積分できる。個別に撃破すれば恐れることはない。
\newpage
\subsection{三角関数の積分}
次はみんな大好き三角関数の積分である。符号にさえ注意すればそこまで恐れることはない。ただ、
三角関数の公式を把握していないと、$\sin x,\cos x$はできるかもしれないが、これが$\sin^2 x,\cos^2 x$となった
ときに計算できなくなってしまう。曖昧な公式があれば復習をするとよい。
\subsubsection{例題}
次の積分を求めよ。
\begin{equation*}
    \int (\sin x+\cos x) dx
\end{equation*}
\subsubsection*{解答}
個別に積分してしまえば一発である。
\begin{equation*}
    \int(\sin x+\cos x)dx=\int \sin xdx+\int \cos xdx=-\cos x+\sin x+C
\end{equation*}
\subsubsection{例題}
次の積分を求めよ。
\begin{equation*}
    (1)\int \sin^2 \frac{x}{2}dx\quad (2)\cos^2 \frac{x}{2}dx 
\end{equation*}
\subsubsection*{解答}
これまでのようにすでに和の形になっていないので最初は戸惑いやすい。半角の公式を使ってしまえば和の形に変形できる。
\begin{align*}
    &(1)\int \sin^2 \frac{x}{2}dx=\int\frac{1-\cos x}{2}dx=\frac{1}{2}(\int dx-\int \cos xdx)=\frac{1}{2}(x-\sin x)+C\\
    &(2)\int \cos^2 \frac{x}{2}dx=\int\frac{1+\cos x}{2}dx=\frac{1}{2}(\int dx+\int \cos xdx)=\frac{1}{2}(x+\sin x)+C 
\end{align*}
この変形は実は結構よく使う。絶対に覚えておくべき変形である。
\newpage
\subsection{指数関数の積分}
ここでは指数関数を扱う。微分しても積分しても形が変わらない$e^x$という特殊な関数をメインで扱う。
\subsubsection{例題}
次の積分を求めよ。
\begin{equation*}
    (1)\int 2^x dx\quad(2)\int e^{x+1}dx
\end{equation*}
\subsubsection*{解答}
(1)公式をそのまま適応して、
\begin{equation*}
    \int 2^x dx=\frac{2^x}{\log 2}+C
\end{equation*}

(2)指数法則$a^b\cdot a^c=a^{b+c}$をもちいて、
\begin{equation*}
    \int e^{x+1}dx=e\int e^xdx=e^{x+1}+C
\end{equation*}
(2)の問題は普通は置換積分を使うが、指数法則を用いても解くことができるということを知ってほしい。\\
\hrulefill
\subsection{演習問題}
以下の積分を求めよ。\\
(1)$\displaystyle\int \sqrt{x}(x^2+1)dx$
\hspace*{20mm}
(2)$\displaystyle\int\sin(x-\frac{\pi}{2})dx$
\hspace*{20mm}
(3)$\displaystyle\int 2\cos xdx$
\\\\
(4)$\displaystyle \int (\cos^2\frac{x}{2}+\sin^2\frac{x}{2})dx$
\hspace*{12mm}
(5)$\displaystyle\int2^{\log x}dx$

\newpage

\section{不定積分の基礎}
ここでは、置換積分・部分積分、有理関数の積分を主に扱う。置換積分、部分積分をなくしては
積分の問題は解くことができない(たまに微分から逆算することもできるが)。有理関数も有理関数の不定積分
が必ず求められることから非常に重要になってくる。この重要性については応用問題の際に語るとして、とりあえず
簡単な問題から取り組んでいこう。
\subsection{置換積分の基礎}
始めに置換積分について扱う。もっとも汎用性が高い変形方法ではないだろうか。一応、置換積分の公式を書いておく。
\begin{equation*}
    \int f(x)dx = \int f(\phi(t))\phi'(t)dt
\end{equation*}
\subsubsection{例題}
次の不定積分を求めよ。
\begin{equation*}
    (1)\int (2x+1)^3 dx \quad (2)\int\tan x dx \quad (3)\int\cos^2 xdx
\end{equation*}
\subsubsection*{解答}
(1)展開して各項ごとに積分することもできるが、置換積分を使ったほうが圧倒的に早い。
$t=2x+1$と置くと、$dt=2dx$より、
\begin{equation*}
    \int \frac{1}{2}t^3dt=\frac{1}{8}t^4+C =\frac{1}{8}(2x+1)^4+C
\end{equation*}
最後に$x$の式に戻すことを忘れないように。

(2)$\tan x=\sin x/\cos x$の公式と$(\cos x)'=-\sin x$を利用し、$t=\cos x$と置くと、
\begin{equation*}
    -\int \frac{(\cos x)'}{\cos x}dx=-\int \frac{1}{t}dt=-\log |t|+C=-\log|\cos x|+C
\end{equation*}

(3)半角の公式を使い、$t=2x$と置くことで、
\begin{equation*}
    \int \frac{1+\cos 2x}{2}dx=\frac{1}{2}(x+2\int \cos tdt)=\frac{1}{2}(x+2\sin 2x)+C
\end{equation*}
慣れてくると、(1)や(2)の問題程度ならわざわざ置換しなくても解くことができるようになる。

置換積分のポイントは、$t=f(x)$と置いたときに発生する$f'(x)$をどう処理するかである。例えば例題(2)では、
$t=\cos x$と置いているが、これは$dt=-\sin x dx$の$\sin x$がちょうど分子にあるからできることなのだ。
よって、うまく微分したらうまく重なるところを探す必要がある。
\subsubsection{例題}
$\displaystyle \int x\sin(x^2)dx$を求めよ。
\subsubsection*{解答}
$t=x^2$と置くと、$\frac{1}{2}dt=xdx$となり、式が簡単になる。
$\displaystyle \frac{1}{2}\int \sin tdt=-\frac{1}{2}\cos t+C=-\frac{1}{2}\cos (x^2)+C$
\newpage
\subsection{部分積分の基礎}
次は部分積分である。置換積分に比べたら使う機会は少ないかもしれないが、使えないと確実に困る。
例えば、今年の京大数学の第一問は部分積分で解く。まず置換積分同様、公式を載せる。
\begin{equation*}
    \int f(x)g'(x)dx=f(x)g(x)-\int f'(x)g(x)dx
\end{equation*}
式だけでは感覚はつかみにくいだろうから、試しに例題を解いてみよう。
\subsubsection{例題}
次の不定積分を求めよ。
\begin{equation*}
    (1)\int x\sin xdx\quad (2)\int xe^x dx \quad (3)\int x\log x dx
\end{equation*}
\subsubsection*{解答}
(1)$f(x)=x,g'(x)=\sin x$と置くと、
\begin{equation*}
    \int x\sin x dx=-x\cos x+\int \cos xdx=-x\cos x+\sin x+C 
\end{equation*}

(2)前問と同様に$f(x)=x,g'(x)=e^x$と置くと、
\begin{equation*}
    \int xe^x dx=xe^x-\int e^xdx=xe^x-e^x+C=(x-1)e^x +C
\end{equation*}

(3)今度は$f(x)=\log x,g'(x)=x$と置くと、
\begin{equation*}
    \int x\log xdx=\frac{1}{2}x^2\log x-\int \frac{1}{2}xdx=\frac{1}{2}x^2\log x-\frac{1}{4}x^2+C
\end{equation*}

例題を見ればわかるように、$xf'(x)$の積分は、$x$を微分することで$f(x)$の積分に変形できる。ただ、
$f(x)$の積分が余りにも複雑な場合には、この変形は使わないほうが良いかもしれない。(3)は、$(\log x)'=\frac{1}{x}$
に気づけば、$x$の積分に変形できる。このような積分は後ほど詳しく学ぶ。
\subsubsection{例題}
次の不定積分を求めよ。
\begin{equation*}
    \int e^x \cos xdx
\end{equation*}
\subsubsection*{解答}

とりあえず、この不定積分を$I$と置いて計算する。二回部分積分を行うと、
\begin{equation*}
    I=\int e^x \cos xdx=e^x\cos x + \int e^x \sin xdx=e^x\cos x+e^x \sin x-I 
\end{equation*}
よって、
\begin{equation*}
    I=\frac{e^x}{2}(\cos x+\sin x)+C
\end{equation*}
このように部分積分を行うことで、右辺に求めたい積分をつくることで、積分を計算することもできる。
\newpage
\subsection{有理関数の積分の基礎}
最後に有理関数の積分についてである。先に有理関数の定義を述べておく。$f(x),g(x)$をそれぞれ多項式とすると、
有理関数$F(x)$は次にようになる。
\begin{equation*}
    F(x)=\frac{f(x)}{g(x)}
\end{equation*}
一般に、\underbar{有理関数の積分は常に求められる}。下線部の性質はとても重要で、これを用いれば、被積分関数を$x$に関する
有理関数に帰着することが出来れば、その積分は必ず求められることになる。
そのため、有理関数の積分を求める練習はしておいたほうが良いだろう。
\subsubsection{例題}
次の不定積分を求めよ。
\begin{equation*}
    (1)\int \frac{x+5}{x-2}dx\quad(2)\int \frac{x}{(x^2+1)^2}dx\quad(3)\int \frac{dx}{x^2-9}
\end{equation*}
\subsubsection*{解答}
(1)$\displaystyle \frac{x+5}{x-2}=1+\frac{7}{x-2}$という風に変形を施せば、
\begin{equation*}
    \int 1+\frac{7}{x-2}dx=x+7\int \frac{dx}{x-2}=x+7\log|x-2|+C
\end{equation*}
(2)有理関数の積分というよりは、置換積分の練習になってしまうが、
\begin{equation*}
    \int \frac{x}{x^2+1}dx=\frac{1}{2}\int \frac{dt}{t}=\frac{1}{2}\log|t|+C=\frac{1}{2}\log(x^2+1)+C
\end{equation*}
(3)そのままでは積分できないので、もちろん変形しなければならない。
\begin{equation*}
    \int \frac{dx}{x^2-9}=\int\frac{dx}{(x-3)(x+3)}=\frac{1}{6}\left(\int \frac{dx}{x-3}-\int\frac{dx}{x+3}\right)
    =\frac{1}{6}\left(\log |x-3|-\log|x+3|\right)+C=\frac{1}{6}\log \left|\frac{x-3}{x+3}\right|+C
\end{equation*}
このように部分分数分解を行うことで計算できる。
\subsubsection{例題}
次の不定積分を求めよ。
\begin{equation*}
    \int \frac{2}{x^2-2x-3}dx
\end{equation*}
\subsubsection*{解答}
部分分数分解によって、$\displaystyle\frac{2}{x^2-2x-3}=\frac{2}{(x-3)(x+1)}=\frac{1}{2}\left(\frac{1}{x-3}-\frac{1}{x+1}\right)$
と変形できるので、
\begin{equation*}
    \int\frac{2}{x^2-2x-3}dx=\int \frac{1}{2}\left(\frac{1}{x-3}-\frac{1}{x+1}\right)dx=\frac{1}{2}\log\left|\frac{x-3}{x+1}\right|+C
\end{equation*}
\newpage
\subsection{演習問題}
次の不定積分を求めよ。

$(1)\displaystyle\int (x+2)^{100}dx$
\hspace{20mm}
$(2)\displaystyle\int \sin^3 x\cos xdx$
\hspace{20mm}
$(3)\displaystyle\int x\cos xdx$\\

$(4)\displaystyle\int \log xdx$
\hspace{27mm}
$(5)\displaystyle\int x\sin(x^2)dx$
\hspace{24mm}
$(6)\displaystyle\int \sqrt{x}\log(x^2)dx$\\

※(6)の問題は、今年の京大数学の問題を一部変えて修正している。\\
\hrulefill
\subsection{$\blacksquare$Coffee Break： $\log |x|$ の絶対値記号}
\begin{screen}
    $\displaystyle\frac{1}{x+a}$の積分が何かと聞かれたら、もちろん$\log|x+a|$と答えるだろう。
    では、$\displaystyle\frac{2x}{x^2+1}$の場合ならどうか？$t=x^2+1$と置換すれば求まるがその答えを
    $\log|x^2+1|$と書いてしまっていないだろうか？$x^2+1$は最小値が$1$の関数である。すなわち、
    常に正なわけである。つまり、$|x^2+1|$は$(x^2+1)$と書くべきなのだ。そもそも、絶対値記号がつくのは、
    真数条件を満たすようにするためである。常に満たしている$x^2+1$に絶対値をつけるのは、おかしいのである。

    ちなみに、複素数まで数を拡張すれば、真数に負の値が入っても問題ない。（例：$\log(-1)=\pi i$）
\end{screen}
\newpage
\section{置換積分}
ここでは置換積分を中心に扱っていく。様々な置換の方法、テクニックを紹介する。
\subsection{$\sqrt{ax^2+bx+c}$の積分}
ひとまず、無理関数の積分から解いてみよう。無理関数の積分といっても様々な形があるが、今回は$\sqrt{ax^2+bx+c}$
に絞って扱っていく。
\subsubsection{$\sqrt{a^2-x^2}$の積分}
まず、$\sqrt{a^2-x^2}$の積分から解く。こういうタイプの積分は、まず根号を外すことを考える。
ここで三角関数の公式$\cos^2 x=1-\sin^2 x$を思い出してみよう。右辺がなんとなく$a^2-x^2$に似ている。
頑張って、$1-\sin^2 x$の形に持ってくれば、$\sqrt{\cos^2 x}=\cos x$となり根号が外れて計算しやすくなる。

よって、$x=a\sin \theta$の置換を行えばよいことがわかる。$dx=a\cos \theta d\theta$であるため、
\begin{equation*}
    \int \sqrt{a^2-x^2}dx=\int \sqrt{a^2-a^2\sin^2\theta}\cdot a\cos\theta d\theta
    =a^2\int \cos^2\theta d\theta=\frac{1}{2}(\theta+\frac{1}{2}\sin(2\theta))+C
\end{equation*}
ここで、$\theta =\arcsin(\frac{x}{a})$より、
\begin{equation*}
    \frac{1}{2}(\theta+\frac{1}{2}\sin(2\theta))+C=\frac{1}{2}(\arcsin(\frac{x}{a})+\frac{x}{a^2}\sqrt{a^2-x^2})+C
\end{equation*}
最後の式変形は$\sin(2\theta)=2\sin\theta\cos\theta$を用いた。

\subsubsection{$\sqrt{x^2+a^2}$の積分}
お次は、$\sqrt{x^2+a^2}$の積分である。これには複数のやり方がある。まず最初に思いつくのが$x=a\tan \theta$の置換だろう。
先ほどの$\sqrt{a^2-x^2}$の積分と同様に、三角関数を用いて根号を外せばいい。ただ、この方法は計算量がほかの方法に比べて多くなってしまう。\\

そこで、$x=a\sinh \theta$と置換することで、計算量を抑えることができる。$\sinh x$を知らない人がいるかもしれないので説明しておくと、
これは双曲線関数と呼ばれ、$\displaystyle \sinh x=\frac{e^x-e^{-x}}{2}$である。読み方は、「ハイパボリックサイン」である。$sin x$と
似た形をしているのは、$\sin x$にとても性質が似通っているからである。もちろん$\cosh x$もある。こちらは$\displaystyle \cosh x=\frac{e^x+e^{-x}}{2}$
となる。ちょっと考えればわかるように$\cosh^2 x=1+\sinh^2 x$である。この性質を利用して、
\begin{equation*}
    \sqrt{1+\sinh^2 x}=\cosh x
\end{equation*}
となれば、根号を外すことができるのだ！\\

とりあえず、今言った２つの方法でそれぞれ積分してみる。
\newpage
まず、$x=a\tan\theta$と置換してみる。
\begin{align*}
    I&=\int \sqrt{x^2+a^2}dx=a^2\int \frac{1}{\cos \theta}\cdot\frac{d\theta}{\cos^2 \theta}
    =a^2\int\frac{d\theta}{\cos^3\theta}=\frac{a^2}{4}\left(\log\left(\frac{1+\sin\theta}{1-\sin\theta}\right)
    +\frac{2\sin \theta}{\cos^2 \theta}\right)+C\\
    &=\frac{a^2}{4}\left(\log\left(\frac{1+\sin(\arctan(\frac{x}{a}))}{1-\sin(\arctan(\frac{x}{a}))}\right)
    +\frac{2\sin(\arctan(\frac{x}{a}))}{\cos^2(\arctan(\frac{x}{a}))}\right)+C\\
    &=\frac{a^2}{4}\left(\log\left(\frac{1+\frac{\frac{x}{a}}{\sqrt{1+\frac{x^2}{a^2}}}}{1-\frac{\frac{x}{a}}{\sqrt{1+\frac{x^2}{a^2}}}}\right)
    +\frac{2\frac{x}{a}(\frac{x^2}{a^2}+1)}{\sqrt{1+\frac{x^2}{a^2}}}\right)+C
\end{align*}
恐ろしい化け物ができているが、整理してあげるときれいな形に収まる。
\begin{align*}
    I&=\frac{a^2}{4}\left(\log\left(\frac{a^2+2x^2+2x\sqrt{x^2+a^2}}{a^2}\right)
    +\frac{2x}{a}\sqrt{1+\frac{x^2}{a^2}}\right)+C\\
    &=\frac{a^2}{4}\left(\log\left(\frac{(x+\sqrt{a^2+x^2})^2}{a^2}\right)
    +\frac{2x}{a^2}\sqrt{a^2+x^2}\right)+C\\
    &=\frac{a^2}{4}\left(2\log\left(\frac{(x+\sqrt{a^2+x^2})}{a}\right)
    +\frac{2x}{a^2}\sqrt{a^2+x^2}\right)+C\\
    &=\frac{1}{2}\left(a^2\log\left(\frac{(x+\sqrt{a^2+x^2})}{a}\right)
    +x\sqrt{a^2+x^2}\right)+C\\
\end{align*}
となる。途中に出てきた$\int dx/\cos^3x$は後ほど解説する。とても計算が大変になるのがわかる(ついでに言うなら計算する
私のほうも大変だった)。

次に、$x=a\sinh \theta$と置換する。$dx=a\cosh\theta d\theta$であるため、
\begin{align*}
    \int\sqrt{x^2+a^2}dx&=a^2\int\sqrt{\sinh^2\theta+1}\cosh\theta d\theta\\
    &=a^2\int \cosh^2 \theta d\theta=a^2\int\frac{1+\cosh(2\theta)}{2}d\theta
\end{align*}
$2\theta=z$と置くと、$dz=2d\theta$となるため、
\begin{equation*}
    =\frac{a^2}{2}(\theta+\frac{1}{2}\int \cosh zdz)=\frac{a^2}{2}(\theta+\frac{1}{2}\sinh(2\theta))+C
\end{equation*}
となる。$\theta=\sinh^{-1}\frac{x}{a}$であるため、
\begin{equation*}
    =\frac{a^2}{2}(\sinh^{-1}\frac{x}{a}+\frac{1}{2}\sinh(2\sinh^{-1}\frac{x}{a}))+C
    =\frac{a^2}{2}(\sinh^{-1}\frac{x}{a}+\frac{x}{a}\sqrt{1+\frac{x^2}{a^2}})+C
\end{equation*}
ここで、$\sinh^{-1}x=\log(x+\sqrt{1+x^2})$であるため(自分で確かめよ)、これを代入して、
\begin{equation*}
    =\frac{a^2}{2}\left(\log\left(\frac{x}{a}+\sqrt{1+\frac{x^2}{a^2}}\right)+\frac{x}{a}\sqrt{1+\frac{x^2}{a^2}}\right)+C=\frac{1}{2}\left(a^2\log\left(\frac{x+\sqrt{a^2+x^2}}{a}\right)+x\sqrt{a^2+x^2}\right)+C
\end{equation*}
となり、$a\tan\theta$で置換した時と同じ結果になっている。$\sinh^{-1}x$を求めるのが少し面倒ではあるが、それでも$\tan \theta$のときよりは明らかに簡単であると思う。
\newpage
\subsubsection{有理関数に帰着させて解く}
基本的に、紹介した二つの場合の積分が解ければ大丈夫なのだが、一応$\sqrt{ax^2+bx+c}$の積分の解き方ものべる。
このタイプの積分は、$\sqrt{a}x+\sqrt{ax^2+bx+c}=t$と置換することで、$t$に関する有理関数に帰着することができるので、
必ず積分できる。その理由を今から説明する。

$\sqrt{ax^2+bx+c}$の有理関数を$f(x,\sqrt{ax^2+bx+c})$と表すことにすると、求める積分は次のようになる。
\begin{equation*}
    \int f(x,\sqrt{ax^2+bx+c})dx
\end{equation*}
ここで、$t=\sqrt{ax^2+bx+c}+\sqrt{a}x$と置換すると、
\begin{equation*}
    x=\frac{t^2-c}{2\sqrt{a}t+b},\quad\sqrt{ax^2+bx+c}=\frac{\sqrt{a}t^2+ct+\sqrt{a}c}{2\sqrt{a}t+c},\quad dx=\frac{2\sqrt{a}t^2+2bt+2\sqrt{a}c}{(2\sqrt{a}t+b)^2}dt
\end{equation*}
であることが容易に分かる。これを代入して、
\begin{equation*}
    \int f(x,\sqrt{ax^2+bx+c})dx=\int f(\frac{t^2-c}{2\sqrt{a}t+b},\frac{\sqrt{a}t^2+ct+\sqrt{a}c}{2\sqrt{a}t+c})\frac{2\sqrt{a}t^2+2bt+2\sqrt{a}c}{(2\sqrt{a}t+b)^2}dt
\end{equation*}
よって、$t$の有理関数に帰着できたため、必ず積分できる。

とはいえ、これは計算量が明らかに多くなるのでおすすめはしない。どうしてもというときの最終手段ではないだろうか？\\
\hrulefill
\subsection{$\blacksquare$CoffeeBreak:双曲線関数}
\begin{screen}
    $\sqrt{a^2+x^2}$の解法のときに$\sinh x,\cosh x$という関数が出てきた。すでにいっているようにこれらは双曲線関数と
    よばれ、三角関数と似通った性質をもっている。例えば、$\cosh^2 x-\sinh^2 x=1$は$\sin^2 x+\cos^2 x=1$と似ている。
    またこれらの加法定理は
    \begin{align*}
        \sinh(x+y)&=\sinh x\cosh y+\cosh x\sinh y\\
        \sinh(x-y)&=\sinh x\cosh y-\cosh x\sinh y\\
        \cosh(x+y)&=\cosh x\cosh y+\sinh x\sinh y\\
        \cosh(x-y)&=\cosh x\cosh y-\sinh x\sinh y
    \end{align*}
    である。ほとんど三角関数のときと一緒であることがわかる。また、定義より$\sinh x$は奇関数、$\cosh x$は偶関数である。
    また、数を複素数まで拡張すると、$\sinh x=\sin ix,\quad \cosh x=\cos ix$であることがわかる。これらは複素関数について
    考えて初めて意味の分かるものである。

    $\sinh x,\cosh x$は三角関数と同じように倍角、半角の公式等がある。これらを自分で導いてみるのもいいかもしれない。
    加法定理から導いてもいいし、もちろん定義から導くのもいいと思う。ちなみに、$\tanh x$というものもある。こちらは$\tan x$同様、
    \begin{equation*}
        \tanh x=\frac{\sinh x}{\cosh x}=\frac{e^x-e^{-x}}{e^x+e^{-x}}
    \end{equation*}
    と$\sinh x,\cosh x$が分子分母にくる。
\end{screen}
\newpage
\subsection{三角関数の積分}
次は三角関数の積分である。始めに言っておくと、$\tan\frac{x}{2}=t$とおけば、\underbar{三角関数の\textbf{有理関数}はすべて積分できる}。
とはいえ、式が複雑な状態でその置換を行えば、計算量が多くなってしまい、計算ミスも発生してしまうだろう。そのためここでは、まず簡単な形に変形できないか
を考え、それが無理そうなら$t=\tan\frac{x}{2}$の置換を行うことにする。もちろん、三角関数の有理関数以外も扱う。例えば、$\sqrt{1-\sin x}$の積分など。

三角関数の積分はよく問題として出やすい。そのため、ここの演算を完璧にしておけば試験などでは6割くらいは取れるのではないだろうか。
（だからといって、他をおろそかにしていいわけではないが。）
\subsubsection{三角関数の有理関数の積分}
ひとまず三角関数の有理関数の積分について色々扱っていく。三角関数の公式を把握しているかがここでの肝となる。忘れている人は教科書でも見直しておこう。
\subsubsection*{例題}
次の積分を求めよ。\\
\begin{equation*}
    (1)\int \frac{dx}{\sin x}\quad (2)\int \sin x\sin 2x\quad
    (3)\int \frac{\sin x}{\sin x+\cos x}dx\quad (4)\int\frac{dx}{\tan x}
\end{equation*}
\subsubsection*{解答}
(1)もちろんこのままでは計算しようがないので変形しよう。$\sin^2 x=1-\cos^2 x$を利用して、
\begin{align*}
    \int \frac{dx}{\sin x}&=\int \frac{\sin x}{1-\cos^2 x}dx\\
    &=-\int \frac{dt}{1-t^2}=\int\frac{dt}{(t-1)(t+1)}=\frac{1}{2}(\int \frac{dt}{t-1}-\int\frac{dt}{t+1})\quad(\text{$t=\cos x$の置換})\\
    &=\frac{1}{2}\log\left|\frac{t-1}{t+1}\right|+C=\log\left|\tan\frac{x}{2}\right|+C
\end{align*}
となる。ただ、これだと計算ミスしてしまうかもしれない。そのため、より簡単なのは分子分母に$\frac{1}{\cos^2 \frac{x}{2}}$をかけるやり方である。こちらのやり方は
これを読んでいる人に任せよう。

(2)倍角の公式を用いて、
\begin{equation*}
    \int\sin x\sin 2xdx=2\int\sin^2 x\cos xdx
\end{equation*}
$(\sin x)'=\cos x$より、$\sin x=t$と置くと、
\begin{equation*}
    =2\int t^2 dt =\frac{2}{3}t^3+C=\frac{2}{3}\sin^3 x+C
\end{equation*}
となる。もしくは和積の公式から、
\begin{equation*}
    \int \sin x\sin2xdx=-\frac{1}{2}(\int \cos 3xdx-\int \cos xdx)=-\frac{1}{2}(\frac{1}{3}\sin 3x-\sin x)+C
\end{equation*}
三倍角の公式$\sin 3x=3\sin x-4\sin^3 x$より
\begin{equation*}
    =-\frac{1}{2}(-\frac{4}{3}\sin^3 x)+C=\frac{2}{3}\sin^3 x+C
\end{equation*}
と、同じ答えになる。どちらの解き方でもよいが、この場合は圧倒的に前者のほうが早い。

(3)見るからにめんどくさそうな式だが、冷静に解いていこう。もちろんそのままでは解けないので変形してあげる必要がある。
分子分母に$\cos x-\sin x$をかけてあげると、
\begin{equation*}
    \int\frac{\sin x}{\sin x+\cos x}dx=\int \frac{\sin x\cos x-\sin^2 x}{\cos^2 x-\sin^2 x}dx=\frac{1}{2}\left(\int\frac{\sin 2x}{\cos 2x}dx-\int \frac{1-\cos 2x}{\cos 2x}dx\right) 
\end{equation*}
となり、解けそうな形に変形できた。$\int \tan x dx=-\log|\cos x|$であることを思い出して、
\begin{equation*}
    =\frac{1}{2}\left(-\frac{1}{2}\log|\cos 2x|-(\int \frac{dx}{\cos 2x})+x\right)=\frac{1}{2}\left(-\frac{1}{2}\log|\cos 2x|+x+\frac{1}{4}\log\left|\frac{1-\sin 2x}{1+\sin 2x}\right|\right)+C
\end{equation*}
少し複雑な形だが、整理してあげると、
\begin{align*}
    &=\frac{1}{2}\left(x+\frac{1}{2}\log\left|\frac{(\cos x-\sin x)}{(\cos x+\sin x)}\cdot\frac{1}{(\cos x-\sin x)(\cos x+\sin x)}\right|\right)+C\\
    &=\frac{1}{2}\left(x+\frac{1}{2}\log\left|\frac{1}{(\cos x+\sin x)^2}\right|\right)+C=\frac{1}{2}\left(x-\log\left|\cos x+\sin x\right|\right)+C
\end{align*}
となる。こちらも計算ミスが多発しそうではあるがいかがだろうか？別解として、分子に$(\sin x+\cos x)-(\cos x-\sin x)$を
作ってあげると、$(\sin x+\cos x)'=\cos x-\sin x$より簡単に積分できる。こちらのほうを別解にするのは単に思いつきづらいからである。
あくまで個人の感想であるが。

(4)$\tan x$の積分と同じようにやればよくて、
\begin{equation*}
    \int\frac{dx}{\tan x}=\int\frac{(\sin x)'}{\sin x}dx=\log|\sin x|+C
\end{equation*}
と簡単に求まる。(1),(2),(3)と少し重めも問題ばかりが来たので、すこし簡単な問題にしてみた。\\

さて、先ほど述べた通り$\tan \frac{x}{2}=t$と置換することで三角関数の有理関数が必ず求まる。
先にその証明から述べる。三角関数の有理関数を$f(\cos x,\sin x)$と置くと、
\begin{equation*}
    x=2\arctan t\Longleftrightarrow dx=\frac{2dt}{1+t^2} 
\end{equation*}
また、$\displaystyle\sin x=\frac{2t}{1+t^2},\cos x=\frac{1-t^2}{1+t^2}$であることから
\begin{equation*}
    \int f(\cos x,\sin x)dx=\int f(\frac{1-t^2}{1+t^2},\frac{2t}{1+t^2})\cdot\frac{2}{1+t^2}dt
\end{equation*}
となり、$t$に関する有理関数に帰着する。有理関数の積分は常に求められるので、$f(\cos x,\sin x)$の積分は必ず求まる。

このことを用いれば、最悪変形方法が思いつかなかった場合に$\tan \frac{x}{2}=t$と置いて積分を求めることができる。ただ、とんでもない
計算量になる場合もあるので注意が必要だ。
\subsubsection*{例題}
$\tan x=t$と置くとき、次のことを証明せよ。
\begin{equation*}
    \sin 2x=\frac{2t}{1+t^2}\quad\cos 2x=\frac{1-t^2}{1+t^2}
\end{equation*}
\subsubsection*{解答}
(1)
\begin{equation*}
    (\text{左辺})=\sin 2x=2\sin x\cos x=2\sqrt{1-\frac{1}{1+\tan^2 x}}\cdot\sqrt{\frac{1}{1+\tan^2 x}}=2\frac{\tan x}{\sqrt{1+\tan^2 x}}\cdot\frac{1}{\sqrt{1+\tan^2 x}}=\frac{2\tan x}{1+\tan^2 x}
\end{equation*}
$t=\tan x$より、
\begin{equation*}
    (\text{左辺})=\frac{2t}{1+t^2}=(\text{右辺})
\end{equation*}

(2)
\begin{equation*}
    (\text{左辺})=\cos 2x=\cos^2 x-\sin^2 x=\frac{1}{1+\tan^2 x}-(1-\frac{1}{1+\tan^2 x})=\frac{2}{1+\tan^2 x}-1=\frac{1-\tan^2 x}{1+\tan^2 x}
\end{equation*}
$t=\tan x$より
\begin{equation*}
    (\text{左辺})=\frac{1-t^2}{1+t^2}=(\text{右辺})
\end{equation*}
\subsubsection*{例題}
次の不定積分を求めよ。
\begin{equation*}
    (1)\int \frac{dx}{a+b\cos x}\quad(2)\int\frac{dx}{a^2\sin^2x+b^2\cos^2 x}
\end{equation*}
\subsubsection*{解答}
$t=\tan\frac{x}{2}$と置換する。
\begin{align*}
    \int \frac{1}{a+b\frac{1-t^2}{1+t^2}}\cdot\frac{2dt}{1+t^2}&=2\int\frac{dt}{(a+b)+(a-b)t^2}=\frac{2}{a-b}\cdot\sqrt{\frac{a-b}{a+b}}\arctan\left(\sqrt{\frac{a-b}{a+b}}\cdot t\right)+C\\
    &=\frac{2}{\sqrt{a^2-b^2}}\arctan\left(\sqrt{\frac{a-b}{a+b}}\tan\frac{x}{2}\right)+C
\end{align*}
と比較的簡単に求まる。

(2)そのまま$t=\tan\frac{x}{2}$と置換してもよいが、式を簡単にしたほうが得策である。
\begin{equation*}
    \int \frac{dx}{a^2\sin^2 x+b^2\cos^2 x}=\int\frac{dx}{a^2\frac{1-\cos 2x}{2}+b^2\frac{1+\cos 2x}{2}}=2\int\frac{dx}{(b^2+a^2)+(b^2-a^2)\cos2x}
\end{equation*}
ここで、(1)の結果から、
\begin{equation*}
    =\frac{1}{\sqrt{(b^2+a^2-b^2+a^2)(b^2+a^2+b^2-a^2)}}\arctan\left(\sqrt{\frac{b^2+a^2-b^2+a^2}{b^2+a^2+b^2-a^2}}\tan x\right)+C
\end{equation*}
もちろん簡単出来て、
\begin{equation*}
    ==\frac{1}{2ab}\arctan\left(\frac{a}{b}\tan x\right)+C
\end{equation*}
となる。
\end{document}